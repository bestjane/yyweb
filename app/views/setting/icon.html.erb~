<%= javascript_include_tag "lib/swfobject" %>
<script>
		var flashvars = {
			js_handler:"jsfun",
			swfID:"avatarEdit",
			picSize:"52428800",
			sourceAvatar:"<%= curr_user.icon_url %>",
			avatarLabel:"头像预览，请注意清晰度",
			avatarAPI:"/setting/upload_icon",
			avatarSize:"84,84|48,48",
			avatarSizeLabel:"大尺寸|小尺寸"
		};
		var params = {
			menu: "false",
			scale: "noScale",
			allowFullscreen: "true",
			allowScriptAccess: "always",
			bgcolor: "",
			wmode: "transparent" // can cause issues with FP settings & webcam
		};
		var attributes = {
			id:"AvatarUpload"
		};
		swfobject.embedSWF(
			"/swf/avatarUpload.swf", 
			"altContent", "100%", "100%", "10.0.0", 
			"/swf/expressInstall.swf", 
			flashvars, params, attributes);
			
		function jsfun(obj)
		{
			if(obj.type == "avatarSuccess") {
			  window.location.href= "/setting/personal";
			};
			if(obj.type == "avatarError") alert("头像上传失败");
			console.log(obj);
		}
</script>
    <div class="title">设置头像</div>
	  <div style="width:750px;height:550px;margin:40px auto 0; padding:10px;border:solid 1px #EFEFEF;">
		<div id="altContent">
			<h1>糟糕！你没有安装FlashPlayer。</h1>
			<p>我准备做一个没有FlashPlayer也能上传图片的功能的，但是最终我还是没有做。换句话说，如果你不安装FlashPlayer就没法上传图片了。</p>
			<p>我猜猜，FlashPlayer应该是绝大部分人都会安装的。你八成在用ipad上网吧。嗯，其实你可以找台装了windows什么的电脑上传了头像，再来用ipad上网。</p>
			<p><b><a href="http://www.adobe.com/go/getflashplayer">点击这里安装 Adobe Flash player</a></b></p>
		</div>
		</div>
